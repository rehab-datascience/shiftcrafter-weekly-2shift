# ShiftCrafter Weekly 2-Shift — パート1：1週間シフト（ブラウザのみ）

二交代制（**日勤・夜勤**）の **1週間シフト自動割当**ツールです。  
インストール不要・**完全クライアントサイド**（データは端末内で処理／送信なし）。

- デモ（GitHub Pages）：**https://rehab-datascience.github.io/shiftcrafter-weekly-2shift/index.html**
- ソース：このリポジトリ直下の `index.html`

---

## できること（今回の範囲）
- 週の開始日を指定 → **7日分**の枠を自動生成  
- 日勤・夜勤の必要人数を設定  
- 各人の **週内最大勤務数** と **夜勤回数上限** を設定  
- **希望休** の考慮（該当日は候補から除外）  
- **公平性**（総割当が少ない人を優先）  
- **連続夜勤の回避**（同一者の翌日連続夜勤は割当しない）  
- 結果の画面表示＋**CSVダウンロード**

> まずは“使える最小構成”（ヒューリスティクス）。完全最適化ではありません。

---

## 使い方
1. デモURLを開く：**https://rehab-datascience.github.io/shiftcrafter-weekly-2shift/index.html** 
2. 入力項目を設定  
   - 週の開始日（例：2025-10-06）  
   - 日勤・夜勤の必要人数  
   - 週内の個人上限／夜勤上限  
   - 看護師名（1行1名）  
   - 休み希望（任意：`名前: YYYY-MM-DD, YYYY-MM-DD`）  
3. **『シフト自動作成』→『CSVダウンロード』**  
4. Excel / GoogleスプレッドシートでCSVを開く（UTF-8推奨）

---

## 入出力の仕様
- 入力は画面から直接指定（外部ファイル不要の最小構成）  
- 休み希望はテキスト欄に **`名前: 日付, 日付`** 形式で複数行  
- 出力CSV：列 `date,day_shift,night_shift`（割当者は `;` 区切り）

### A. Wide形式（本ツールの既定想定・人に配布しやすい）
ファイル名：schedule_output.csv（文字コード：UTF-8（BOM付）／改行：LF）

#### 列定義
date：日付（YYYY-MM-DD）
dow：曜日（Mon–Sun など）
need_day：日勤の必要人数（入力値の写し）
need_night：夜勤の必要人数（入力値の写し）
day_staff_1 ... day_staff_K：日勤に割り当てられた職員名（左から充当）
night_staff_1 ... night_staff_K：夜勤に割り当てられた職員名（左から充当）

#### 値の扱い
充足できない枠は空欄（または UNASSIGNED）
同一日に同一名が重複しないように出力
並び順：date 昇順

#### 例（抜粋）
date,dow,need_day,need_night,day_staff_1,day_staff_2,night_staff_1
2025-10-06,Mon,2,1,田中,鈴木,佐藤
2025-10-07,Tue,2,1,鈴木,佐藤,田中
2025-10-08,Wed,2,1,田中,佐藤,鈴木

#### 備考
Excelで文字化けする場合は、BOM付きCSVを推奨（本ツールのデフォルト）。
スプレッドシートで共有する際は、1行目をヘッダとして取り込んでください。

### B. Long形式（分析・集計向け、将来のオプション）
#### 列定義
date：日付（YYYY-MM-DD）
dow：曜日
shift：Day / Night
staff：職員名（1行＝1割当）

#### 例（抜粋）
date,dow,shift,staff
2025-10-06,Mon,Day,田中
2025-10-06,Mon,Day,鈴木
2025-10-06,Mon,Night,佐藤

---

## 動作確認のチェックリスト
- デモURLにアクセス → 画面表示／ボタンがクリック可能  
- 「シフト自動作成」で **日勤/夜勤** の割当が表示される  
- 「CSVダウンロード」でファイルが取得でき、**日本語が文字化けしない**  
- 日勤/夜勤の必要人数を極端に大きくすると、**未充足セル**が出る（想定動作）  
- 休み希望日には割当されない（遵守できている）

---

## 既知の制約・限界
- 夜勤明けの自動休、連勤制限、技能タグ必須などの詳細制約は未実装  
- 完全最適化（数理最適化）は未対応（現状は公平性重視のヒューリスティクス）

---

## ロードマップ（予告）
- **Part 2：1か月シフト**（月カレンダー）  
- **Part 3：三交代**（早・日・夜）  
- **Part 4：時短勤務**（個別の勤務時間）  
- **Part 5：早出・遅出**（勤務/休憩時間の考慮）  
- **Part 6：看護助手を含む混成シフト**（ロール/技能タグの充足）

---

## フィードバック歓迎
欲しい機能・気づいた点は **Issue** へ（絵文字投票歓迎）。  
- Issues: `https://github.com/rehab-datascience/shiftcrafter-weekly-2shift/issues`

---

## 免責
- 本ツールは教育・業務補助を目的とした**クライアントサイド**Webアプリです。  
- **データはブラウザ内のみで処理**され、外部サーバへ送信されません。  
- 本ツールの利用によって生じた結果・損害について、作者は一切の責任を負いません。  
- 実運用時は所属施設の規程・労務基準・個人情報保護方針に従ってください。

## ライセンス
MIT
